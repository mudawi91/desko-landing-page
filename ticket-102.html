<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <title>Ticket Detail #102 - DeskGo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="./favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;600;700&display=swap"
        rel="stylesheet">
    <style>
        /* PHASE 1: THEME COLORS (CSS Variables) */
        :root {
            --color-bg-primary: #f3f4f6;
            --color-bg-secondary: #ffffff;
            --color-text-primary: #111827;
            --color-text-secondary: #4b5563;
            --color-border: #e5e7eb;
            --color-accent-bg: #e0f2fe;
            --color-accent: #2563eb;
            --color-shadow: rgba(0, 0, 0, 0.05);
            --color-sidebar-bg: #ffffff;
            --color-overlay-bg: rgba(0, 0, 0, 0.5);
        }

        [data-theme='dark'] {
            --color-bg-primary: #111827;
            --color-bg-secondary: #1f2937;
            --color-text-primary: #f9fafb;
            --color-text-secondary: #d1d5db;
            --color-border: #374151;
            --color-accent-bg: #1e3a8a;
            --color-accent: #60a5fa;
            --color-shadow: rgba(0, 0, 0, 0.05);
            --color-sidebar-bg: #1f2937;
            --color-overlay-bg: rgba(0, 0, 0, 0.7);
        }

        /* Global Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            /* CHANGED: Applied Josefin Sans */
            font-family: 'Josefin Sans', sans-serif;
            background-color: var(--color-bg-primary);
            color: var(--color-text-primary);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Layout (Desktop Default) */
        .sidebar {
            width: 250px;
            background-color: var(--color-sidebar-bg);
            border-right: 1px solid var(--color-border);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .main-content {
            flex-grow: 1;
            padding: 2rem;
            display: flex;
            flex-direction: column;
        }

        /* Sidebar Elements */
        .logo a {
            display: block;
            margin-bottom: 2rem;
        }

        .logo img {
            height: 120px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            color: var(--color-text-secondary);
            text-decoration: none;
            transition: background-color 0.2s, color 0.2s;
            font-weight: 500;
        }

        .nav-link svg {
            width: 20px;
            height: 20px;
            margin-right: 0.75rem;
        }

        .nav-link.active,
        .nav-link:hover {
            background-color: var(--color-accent-bg);
            color: var(--color-accent);
        }

        .sidebar .btn-primary {
            margin-top: auto;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            background-color: var(--color-accent);
            color: white;
            text-decoration: none;
            text-align: center;
            transition: background-color 0.2s;
        }

        .sidebar .btn-primary:hover {
            background-color: #1e40af;
        }

        /* Header and Mobile Menu Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
        }

        #mobileMenuButton {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            color: var(--color-text-primary);
        }

        #mobileMenuButton svg {
            width: 30px;
            height: 30px;
            display: block;
        }

        /* Badge Styles */
        .badge {
            display: inline-block;
            padding: 0.3rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
            /* Prevent badge text from wrapping */
        }

        .bg-red-100 {
            background-color: #fee2e2;
        }

        .text-red-800 {
            color: #991b1b;
        }

        .bg-blue-100 {
            background-color: #dbeafe;
        }

        .text-blue-800 {
            color: #1e40af;
        }

        .bg-gray-200 {
            background-color: #e5e7eb;
        }

        .bg-gray-300 {
            background-color: #d1d5db;
        }

        .text-gray-800 {
            color: #1f2937;
        }

        .bg-green-100 {
            background-color: #d1fae5;
        }

        .text-green-800 {
            color: #065f46;
        }

        /* Dark Mode Badge Overrides */
        [data-theme='dark'] .bg-red-100 {
            background-color: #450a0a;
        }

        [data-theme='dark'] .text-red-800 {
            color: #fecaca;
        }

        [data-theme='dark'] .bg-blue-100 {
            background-color: #1e3a8a;
        }

        [data-theme='dark'] .text-blue-800 {
            color: #93c5fd;
        }

        [data-theme='dark'] .bg-gray-200,
        [data-theme='dark'] .bg-gray-300 {
            background-color: #374151;
        }

        [data-theme='dark'] .text-gray-800 {
            color: #e5e7eb;
        }

        [data-theme='dark'] .bg-green-100 {
            background-color: #064e3b;
        }

        [data-theme='dark'] .text-green-800 {
            color: #a7f3d0;
        }

        /* --- Ticket Detail Specific Styles --- */
        .ticket-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--color-text-primary);
        }

        .ticket-meta {
            font-size: 0.875rem;
            color: var(--color-text-secondary);
            margin-bottom: 1.5rem;
        }

        .priority-high {
            color: #ef4444;
            font-weight: 600;
        }

        .priority-low {
            color: #10b981;
            font-weight: 600;
        }

        /* Card Styles */
        .card {
            background-color: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px var(--color-shadow);
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--color-border);
        }

        .card p {
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .reply-section textarea {
            width: 100%;
            min-height: 100px;
            padding: 0.75rem;
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            background-color: var(--color-bg-primary);
            color: var(--color-text-primary);
            margin-bottom: 1rem;
            resize: vertical;
        }

        .btn {
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-success {
            background-color: #10b981;
            color: white;
        }

        .btn-success:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }

        .btn-danger {
            background-color: #ef4444;
            color: white;
        }

        /* 2-Column Grid for Ticket Detail */
        .ticket-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .agent-sidebar .card-title {
            margin-top: 0;
        }

        .agent-sidebar p {
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        /* Mobile adjustments */
        @media (max-width: 900px) {
            .ticket-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                width: 250px;
                transform: translateX(-100%);
                box-shadow: 2px 0 5px var(--color-shadow);
                display: flex;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                padding: 1rem;
                width: 100%;
            }

            .header {
                flex-direction: row;
                justify-content: flex-start;
                align-items: center;
                gap: 1rem;
                margin-bottom: 1rem;
            }

            .header h1 {
                font-size: 1.5rem;
                margin-bottom: 0;
                order: 2;
            }

            #mobileMenuButton {
                display: block;
                order: 1;
            }

            .sidebar-backdrop {
                display: none;
            }

            .sidebar-backdrop.open {
                display: block;
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background-color: var(--color-overlay-bg);
                z-index: 999;
            }
        }
    </style>
</head>

<body>
    <div class="sidebar-backdrop" id="sidebarBackdrop"></div>
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <a href="index.html">
                <img src="./logo.png" alt="DeskGo Logo">
            </a>
        </div>
        <a href="tickets.html" class="nav-link active">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M19.5 3a2.25 2.25 0 00-2.25-2.25H6.75A2.25 2.25 0 004.5 3v18a2.25 2.25 0 002.25 2.25h10.5A2.25 2.25 0 0019.5 21V3zM16.5 6a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm0 3a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm0 3a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm0 3a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm0 3a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6 6.75A.75.75 0 016.75 6h2.25a.75.75 0 010 1.5H6.75A.75.75 0 016 6.75zM6 9.75A.75.75 0 016.75 9h2.25a.75.75 0 010 1.5H6.75A.75.75 0 016 9.75zM6 12.75A.75.75 0 016.75 12h2.25a.75.75 0 010 1.5H6.75A.75.75 0 016 12.75zM6 15.75A.75.75 0 016.75 15h2.25a.75.75 0 010 1.5H6.75A.75.75 0 016 15.75zM6 18.75A.75.75 0 016.75 18h2.25a.75.75 0 010 1.5H6.75A.75.75 0 016 18.75z" />
            </svg>
            Tickets
        </a>
        <a href="dashboard.html" class="nav-link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M3 3.75A.75.75 0 013.75 3h16.5a.75.75 0 01.75.75v16.5a.75.75 0 01-.75.75H3.75a.75.75 0 01-.75-.75V3.75zM6.75 12a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM12.75 15a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM15.75 9a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM9.75 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"
                    clip-rule="evenodd" />
            </svg>
            Dashboard (Charts)
        </a>
        <a href="login.html" class="nav-link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M7.5 3a.75.75 0 000 1.5H9v.75A7.5 7.5 0 011.5 12a7.5 7.5 0 017.5-7.5V4.5h1.5a.75.75 0 000-1.5H7.5zm9 9a1.5 1.5 0 100 3 1.5 1.5 0 000-3zM15 12a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5H15.75A.75.75 0 0115 12zM7.5 17.25A7.502 7.502 0 011.5 12a7.5 7.5 0 017.5-7.5V5.25H9v-.75A7.5 7.5 0 0116.5 12a7.5 7.5 0 01-7.5 7.5V18h-1.5a.75.75 0 010-1.5H7.5z"
                    clip-rule="evenodd" />
            </svg>
            Logout
        </a>

        <a href="new-ticket.html" class="btn btn-primary">
            Submit New Ticket
        </a>
    </div>

    <div class="main-content">
        <div class="header">
            <button id="mobileMenuButton">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                </svg>
            </button>
            <h1>Ticket Detail</h1>
            <a href="tickets.html" class="nav-link"
                style="margin-left: auto; color: var(--color-accent); font-weight: 600; text-decoration: underline;">
                &larr; Back to Tickets List
            </a>
        </div>
        <div class="ticket-title" id="ticketTitle">
            Missing Q3 Billing Report
        </div>
        <div class="ticket-meta">
            <span id="ticketID">Ticket #102</span>
            |
            <span id="statusBadge" class="badge bg-blue-100 text-blue-800">PROCESSING</span>
            |
            <span id="priority">Priority: <span class="priority-low">Low</span></span>
        </div>

        <div class="ticket-grid">
            <div class="main-detail">
                <div class="card">
                    <div class="card-title">Requester Details</div>
                    <p><strong>Name:</strong> Bob Smith</p>
                    <p><strong>Email:</strong> bob.s@company.com</p>
                    <p><strong>Department:</strong> Accounting</p>
                </div>

                <div class="card">
                    <div class="card-title">Original Description</div>
                    <p id="description">
                        I am preparing our quarterly financials and the Q3 Billing Report is nowhere to be found in the
                        shared drive. Can someone please generate and upload it? This is not urgent, but needed by end
                        of week.
                    </p>
                </div>

                <div class="reply-section">
                    <div class="card-title">Agent Reply</div>
                    <textarea placeholder="Type your response here..." id="agentReply"></textarea>
                    <button class="btn btn-success" id="sendReply">Send Public Reply</button>
                    <button class="btn" id="addNote"
                        style="background-color: var(--color-bg-primary); color: var(--color-text-primary); margin-left: 1rem;">Add
                        Private Note</button>
                </div>
            </div>

            <div class="agent-sidebar">
                <div class="card-title">Ticket Management</div>

                <p>
                    <strong>Category:</strong>
                    <select
                        style="width: 100%; padding: 0.5rem; border-radius: 0.5rem; border: 1px solid var(--color-border); background-color: var(--color-bg-primary); color: var(--color-text-primary);">
                        <option>Access</option>
                        <option selected>Billing</option>
                        <option>Technical</option>
                        <option>Feature Request</option>
                    </select>
                </p>

                <p>
                    <strong>Assigned Agent:</strong>
                    <select
                        style="width: 100%; padding: 0.5rem; border-radius: 0.5rem; border: 1px solid var(--color-border); background-color: var(--color-bg-primary); color: var(--color-text-primary);">
                        <option>You (John Doe)</option>
                        <option>Jane Smith</option>
                        <option>IT Team</option>
                    </select>
                </p>

                <p><strong>Created Date:</strong> 2024-11-19 02:00 PM</p>
                <p><strong>Last Update:</strong> 2024-11-20 08:30 AM</p>

                <div class="action-buttons">
                    <button class="btn btn-success" id="resolveTicket">Mark as RESOLVED</button>
                    <button class="btn btn-danger" id="escalateTicket">Escalate to Tier 2</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- JAVASCRIPT FOR MOBILE MENU ---
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('sidebarBackdrop');
            const isOpen = sidebar.classList.toggle('open');
            backdrop.classList.toggle('open', isOpen);
            document.body.style.overflow = isOpen ? 'hidden' : 'auto';
        }

        // --- JAVASCRIPT FOR BUTTON ACTIONS (UPDATED) ---
        function setupTicketActions() {
            const resolveButton = document.getElementById('resolveTicket');
            const escalateButton = document.getElementById('escalateTicket');
            const sendReplyButton = document.getElementById('sendReply');
            const addNoteButton = document.getElementById('addNote');
            const statusBadge = document.getElementById('statusBadge');
            const agentReply = document.getElementById('agentReply');

            // Modal elements
            const modal = document.getElementById('actionModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalConfirm = document.getElementById('modalConfirm');
            const modalCancel = document.getElementById('modalCancel');

            // Helper function to show modal
            function showModal(title, body, confirmText, confirmClass, onConfirm) {
                modalTitle.textContent = title;
                modalBody.textContent = body;
                modalConfirm.textContent = confirmText;

                // Reset button classes and apply new one
                modalConfirm.className = 'btn';
                modalConfirm.classList.add(confirmClass);

                // Clear previous listeners and attach new one
                const newConfirm = modalConfirm.cloneNode(true);
                modalConfirm.parentNode.replaceChild(newConfirm, modalConfirm);

                newConfirm.addEventListener('click', () => {
                    onConfirm();
                    modal.style.display = 'none';
                }, {once: true});

                modalCancel.addEventListener('click', () => {
                    modal.style.display = 'none';
                    // Re-attach the listeners to modalConfirm for next time
                    setupTicketActions();
                }, {once: true});

                modal.style.display = 'flex';
            }

            // 1. Mark as RESOLVED action
            resolveButton.addEventListener('click', () => {
                if (statusBadge.textContent.toUpperCase() !== 'RESOLVED') {
                    showModal(
                        'Confirm Resolution',
                        'Are you sure you want to mark Ticket #102 as RESOLVED? This will lock the reply section.',
                        'Yes, Resolve Ticket',
                        'btn-success',
                        () => {
                            // Action to perform on confirmation
                            statusBadge.textContent = 'RESOLVED';
                            statusBadge.className = 'badge bg-green-100 text-green-800';
                            agentReply.disabled = true;
                            sendReplyButton.disabled = true;
                            addNoteButton.disabled = true;
                        }
                    );
                } else {
                    alert('This ticket is already RESOLVED.');
                }
            });

            // 2. Escalate action
            escalateButton.addEventListener('click', () => {
                showModal(
                    'Confirm Escalation',
                    'Are you sure you want to ESCALATE Ticket #102 to Tier 2 Support?',
                    'Yes, Escalate',
                    'btn-danger', // Using danger color for escalation
                    () => {
                        // Action to perform on confirmation
                        alert('Ticket #102 is now ESCALATED to Tier 2.');
                    }
                );
            });

            // 3. Send Public Reply action (UNCHANGED)
            sendReplyButton.addEventListener('click', () => {
                if (agentReply.value.trim() !== '') {
                    alert('Public Reply Sent for Ticket #102: "' + agentReply.value.substring(0, 50).trim() + '..."');
                    agentReply.value = ''; // Clear the input
                } else {
                    alert('Please enter a reply before sending.');
                }
            });

            // 4. Add Private Note action (UNCHANGED)
            addNoteButton.addEventListener('click', () => {
                if (agentReply.value.trim() !== '') {
                    alert('Private Note Added for Ticket #102: "' + agentReply.value.substring(0, 50).trim() + '..."');
                    agentReply.value = ''; // Clear the input
                } else {
                    alert('Please enter a note before adding.');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Theme setup
            const currentTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', currentTheme);

            // Attach event listeners for the mobile menu
            document.getElementById('mobileMenuButton').addEventListener('click', toggleMobileMenu);
            document.getElementById('sidebarBackdrop').addEventListener('click', toggleMobileMenu);

            // Setup button actions
            setupTicketActions();

            // Close menu if a nav link is clicked
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        if (document.getElementById('sidebar').classList.contains('open')) {
                            toggleMobileMenu();
                        }
                    }
                });
            });
        });
    </script>
    <div id="actionModal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--color-overlay-bg); z-index: 2000; align-items: center; justify-content: center;">
        <div
            style="background-color: var(--color-bg-secondary); padding: 2rem; border-radius: 0.75rem; width: 90%; max-width: 400px; box-shadow: 0 4px 6px var(--color-shadow);">
            <h3 id="modalTitle" class="card-title" style="margin-bottom: 0.5rem; border-bottom: none;">Confirm Action
            </h3>
            <p id="modalBody" style="margin-bottom: 1.5rem; color: var(--color-text-secondary);"></p>
            <div style="display: flex; justify-content: flex-end; gap: 0.75rem;">
                <button class="btn" id="modalCancel"
                    style="background-color: var(--color-bg-primary); color: var(--color-text-primary);">Cancel</button>
                <button class="btn btn-success" id="modalConfirm">Confirm</button>
            </div>
        </div>
    </div>
</body>

</html>